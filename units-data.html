<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>تحديد الوحدات المفروشة</title>
    <style>
        body {
            background: #111;
            color: #fff;
            font-family: "Cairo", sans-serif;
            text-align: center;
            padding: 20px;
        }

        h1 {
            margin-bottom: 20px;
        }

        .unit-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 20px;
            direction: rtl;
        }

        .unit-item {
            position: relative;
        }

        input[type="checkbox"] {
            display: none;
        }

        label {
            background: #222;
            border-radius: 10px;
            padding: 12px;
            cursor: pointer;
            display: block;
            transition: 0.3s;
        }

        input:checked+label {
            background: #00b894;
            color: #fff;
            box-shadow: 0 0 10px #00b894;
        }

        button {
            margin-top: 25px;
            padding: 12px 30px;
            background: #00b894;
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-size: 18px;
            transition: 0.3s;
        }

        button:hover {
            background: #019870;
        }
    </style>
</head>

<body dir="rtl">
  <h1>تحديد الوحدات المفروشة</h1>
  <div id="units-container" class="units-grid"></div>
  <button onclick="submitData()">💾 حفظ البيانات</button>



    <script>
        // رابط Google Apps Script
        const sheetURL = "https://script.google.com/macros/s/AKfycbxd02oM4G_e8gcLCSXD0YxVcqAXmO57gf0SIDaH31YfLGPZKXivtuRZIfo0Y-h9om2Wnw/exec";

        // إنشاء الوحدات من V-1 إلى V-98
        function generateUnits() {
            const container = document.getElementById("units-container");
            container.innerHTML = "";
            for (let i = 1; i <= 98; i++) {
                const unitId = `V-${i}`;
                const wrapper = document.createElement("div");
                wrapper.className = "unit-box";

                const checkbox = document.createElement("input");
                checkbox.type = "checkbox";
                checkbox.id = unitId;
                checkbox.value = unitId;

                const label = document.createElement("label");
                label.setAttribute("for", unitId);
                label.textContent = unitId;

                wrapper.appendChild(checkbox);
                wrapper.appendChild(label);
                container.appendChild(wrapper);
            }
        }

        // إرسال البيانات للمشرف والشيت
        async function submitData() {
            const selected = [...document.querySelectorAll("input[type=checkbox]:checked")].map(cb => cb.value);
            if (selected.length === 0) {
                alert("⚠️ يرجى اختيار وحدة واحدة على الأقل");
                return;
            }

            try {
                const response = await fetch(sheetURL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ furnishedUnits: selected })
                });

                const result = await response.json();
                console.log("Result:", result);
                alert(result.message || "✅ تم حفظ البيانات بنجاح!");
            } catch (error) {
                console.error("Error while submitting:", error);
                alert("❌ حدث خطأ أثناء الحفظ، حاول مرة أخرى.");
            }
        }

        // عندما يتم تحميل الصفحة
        document.addEventListener("DOMContentLoaded", () => {
            generateUnits();
        });
    </script>

</body>

</html>