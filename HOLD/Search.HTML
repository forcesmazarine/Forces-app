<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forces plus - Mazarine</title>
 <link rel="stylesheet" href="css/search.css">
</head>
<body>
  

  <h2>ğŸ” Ø¨Ø­Ø« Ø¹Ù† Ù…Ø§Ù„Ùƒ Ø§Ù„ÙˆØ­Ø¯Ø©</h2>

  <div class="btn-container">

    <button onclick="selectSheet('V')">V</button>
    <button onclick="selectSheet('TV')">TV</button>
    <button onclick="selectSheet('IS')">IS</button>
    <button onclick="selectSheet('CH')">CH</button>
  </div>

  <div id="inputSection">
    <input type="text" id="unitInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„ÙˆØ­Ø¯Ø©">
    <div id="tvOption">
      <label>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ÙˆØ­Ø¯Ø©:</label>
      <select id="tvLetter">
        <option value="A">A</option>
        <option value="B">B</option>
      </select>
    </div>
    <br><br>
    <button onclick="search()">Ø¨Ø­Ø«</button>
  </div>

  <div id="result"></div>
  <!-- Footer -->
    <div class="app-footer">
      <a href="index.html" class="home-btn">
        <span class="home-icon">ğŸšï¸</span>
      </a>
    </div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbw5ONye_ORDwlTqvE2ONCepxk-kGJEYLyf-3vNGtzmMlb-Qyt5BowhN9XLNIE8tj76IeA/exec";
    let selectedSheet = "";

    function selectSheet(sheet) {
      selectedSheet = sheet;
      document.getElementById("inputSection").style.display = "block";
      document.getElementById("result").textContent = "";

      const input = document.getElementById("unitInput");
      const tvOption = document.getElementById("tvOption");

      input.value = "";
      tvOption.style.display = "none";

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ØµÙØ­Ø©
      if (sheet === "CH") {
        input.placeholder = "Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ù…Ø²Ø¯ÙˆØ¬ (Ù…Ø«Ù„Ø§Ù‹ 11-21)";
        input.pattern = "[0-9]+-[0-9]+"; // ÙŠÙ‚Ø¨Ù„ Ø£Ø±Ù‚Ø§Ù… ÙÙŠÙ‡Ø§ Ø´Ø±Ø·Ø©
      } else {
        input.placeholder = "Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„ÙˆØ­Ø¯Ø©";
        input.pattern = "[0-9]+"; // Ø£Ø±Ù‚Ø§Ù… Ø¹Ø§Ø¯ÙŠØ© ÙÙ‚Ø·
      }

      // Ù„Ùˆ Ø§Ø®ØªØ§Ø± TV Ù†Ø¹Ø±Ø¶ Ø§Ø®ØªÙŠØ§Ø± A/B
      if (sheet === "TV") {
        tvOption.style.display = "block";
      }
    }

    async function search() {
      const unitNumber = document.getElementById("unitInput").value.trim();
      const tvLetter = document.getElementById("tvLetter").value;
      const resultDiv = document.getElementById("result");

      if (!selectedSheet || !unitNumber) {
        resultDiv.textContent = "âš ï¸ Ø¨Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„ØµÙØ­Ø© ÙˆÙƒØªØ§Ø¨Ø© Ø±Ù‚Ù… Ø§Ù„ÙˆØ­Ø¯Ø©";
        return;
      }

      let fullUnit;
      if (selectedSheet === "TV") {
        fullUnit = `MZ-TV-${unitNumber}-${tvLetter}`;
      } else {
        fullUnit = `MZ-${selectedSheet}-${unitNumber}`;
      }

      try {
        const response = await fetch(`${scriptURL}?sheet=${selectedSheet}&unit=${encodeURIComponent(fullUnit)}`);
        const text = await response.text();
        resultDiv.textContent = text;
      } catch (err) {
        resultDiv.textContent = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„";
      }
    }
  </script>

</body>
</html>
